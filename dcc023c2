#!/usr/bin/python

def carry_around_add(a, b):
  c = a + b
  return(c &0xffff)+(c >>16)

def checksum(msg):
  s =0
  for i in range(0, len(msg),2):
    w = ord(msg[i])+(ord(msg[i+1])<<8)
    s = carry_around_add(s, w)
  return~s &0xffff

import sys
import socket

for arg in sys.argv[1:]:
  #print arg
  if arg == '-c':
    #print 'Cliente'
    for aux in sys.argv[2:3]:
      ip,port=aux.split(":")
    auxInput = sys.argv[3:4]
    auxOutput = sys.argv[4:]
    defInput = ''.join(auxInput)		#Input definitivo
    defOutput = ''.join(auxOutput)		#Output definitivo
    HOST = ip
    PORT = int(port)
    tcp = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    dest = (HOST, PORT)
    tcp.connect(dest)
    file = open(defInput,'rb')
    tcp.close()
    #msg = raw_input()
    #while msg <> '\x18':
      #tcp.send (msg)
      #msg = tcp.recv(1024)
      #tcp.close()

  if arg == '-s':
    #print 'Servidor'
    port = sys.argv[2:3]
    HOST = ''
    PORT = int(''.join(port))
    auxInput = sys.argv[3:4]
    auxOutput = sys.argv[4:]
    defInput = ''.join(auxInput)		#Input definitivo
    defOutput = ''.join(auxOutput)		#Output definitivo
    tcp = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    orig = (HOST, PORT)
    tcp.bind(orig)
    tcp.listen(1)
    while True:
      con, cliente = tcp.accept()
      file = open(defInput,'rb')
      con.close()
